<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Scoreboard – Boßel Wettkampfrechner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .container { border: 1px solid #ccc; padding: 15px; margin-bottom: 20px; }
    input, button { margin: 5px; padding: 5px; }
    table { border-collapse: collapse; width: 100%; max-width: 900px; }
    th, td { border: 1px solid #000; padding: 5px; text-align: center; }
  </style>
</head>
<body>
  <h1>Scoreboard – Boßel Wettkampfrechner</h1>
  <div class="container">
    <strong>Wettkampf-ID:</strong> <span id="compIdDisplay"></span>
  </div>
  
  <!-- Beispiel Scoreboard: Eine einfache Tabelle für zwei Runden -->
  <div class="container" id="scoreboardContainer">
    <table>
      <thead>
        <tr>
          <th>Runde</th>
          <th>Team A</th>
          <th>Team B</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1</td>
          <td><input type="number" id="teamAScore1" value="0"></td>
          <td><input type="number" id="teamBScore1" value="0"></td>
        </tr>
        <tr>
          <td>2</td>
          <td><input type="number" id="teamAScore2" value="0"></td>
          <td><input type="number" id="teamBScore2" value="0"></td>
        </tr>
      </tbody>
    </table>
    <div>
      <button id="calculateBtn">Ergebnis berechnen</button>
      <button id="backBtn">Zurück</button>
    </div>
    <div>
      <strong>Gesamtergebnis:</strong>
      <span id="resultDisplay"></span>
    </div>
  </div>
  
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.17.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.2/firebase-database-compat.js"></script>
  <script>
    // Firebase-Konfiguration (wie in index.html)
    const firebaseConfig = {
      apiKey: "AIzaSyBj_ylDl8WgUnXbpwI1pfgWnvZSoQ9ML3A",
      authDomain: "wettkampf-f6f92.firebaseapp.com",
      databaseURL: "https://wettkampf-f6f92-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "wettkampf-f6f92",
      storageBucket: "wettkampf-f6f92.firebasestorage.app",
      messagingSenderId: "161090727748",
      appId: "1:161090727748:web:33f4ff7ce4f6e5c08f7111",
      measurementId: "G-WCV2950HGK"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    
    // Aus URL-Parametern lesen
    const urlParams = new URLSearchParams(window.location.search);
    const compId = urlParams.get("compId");
    const role = urlParams.get("role") || "zuschauer"; // Standardmäßig Zuschauer
    if (!compId) {
      alert("Keine Wettkampf-ID gefunden!");
    }
    document.getElementById("compIdDisplay").textContent = compId;
    
    // Beispielhafte Funktion zum Berechnen des Gesamtergebnisses
    function calculateResult() {
      let teamASum = 0;
      let teamBSum = 0;
      const rounds = 2; // Anzahl der Runden
      for (let i = 1; i <= rounds; i++) {
        teamASum += Number(document.getElementById("teamAScore" + i).value);
        teamBSum += Number(document.getElementById("teamBScore" + i).value);
      }
      document.getElementById("resultDisplay").textContent = "Team A: " + teamASum + " - Team B: " + teamBSum;
      // Ergebnis in Firebase speichern
      const resultData = {
        teamA: teamASum,
        teamB: teamBSum,
        timestamp: Date.now()
      };
      db.ref('competitions/' + compId + '/results').set(resultData);
    }
    
    document.getElementById("calculateBtn").addEventListener("click", calculateResult);
    document.getElementById("backBtn").addEventListener("click", () => {
      window.location.href = "index.html";
    });
    
    // Rollenspezifisches Verhalten: Zuschauer dürfen keine Eingaben tätigen
    document.addEventListener("DOMContentLoaded", () => {
      if (role === "zuschauer") {
        // Alle Inputfelder deaktivieren
        const inputs = document.querySelectorAll("input");
        inputs.forEach(input => input.disabled = true);
        // Buttons außer "Zurück" ausblenden
        const buttons = document.querySelectorAll("button");
        buttons.forEach(btn => {
          if (btn.id !== "backBtn") {
            btn.style.display = "none";
          }
        });
      }
    });
    
    // Hier könnte zusätzlicher Code folgen, um beispielsweise den Scoreboard-Zustand live aus Firebase zu laden.
  </script>
</body>
</html>